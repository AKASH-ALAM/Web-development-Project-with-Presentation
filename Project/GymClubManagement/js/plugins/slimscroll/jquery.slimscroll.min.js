/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.0.6
 *
 */(function(e){jQuery.fn.extend({slimScroll:function(t){var n={wheelStep:20,width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200},r=e.extend(n,t);this.each(function(){function S(e,t,n){var i=e,s=v.outerHeight()-b.outerHeight();if(t){i=parseInt(b.css("top"))+e*parseInt(r.wheelStep)/100*b.outerHeight();i=Math.min(Math.max(i,0),s);b.css({top:i+"px"})}l=parseInt(b.css("top"))/(v.outerHeight()-b.outerHeight());i=l*(v[0].scrollHeight-v.outerHeight());if(n){i=e;var u=i/v[0].scrollHeight*v.outerHeight();u=Math.min(Math.max(u,0),s);b.css({top:u+"px"})}v.scrollTop(i);N();C()}function T(){f=Math.max(v.outerHeight()/v[0].scrollHeight*v.outerHeight(),p);b.css({height:f+"px"})}function N(){T();clearTimeout(u);if(l==~~l){d=r.allowPageScroll;if(c!=l){var e=~~l==0?"top":"bottom";v.trigger("slimscroll",e)}}c=l;if(f>=v.outerHeight()){d=!0;return}b.stop(!0,!0).fadeIn("fast");r.railVisible&&y.stop(!0,!0).fadeIn("fast")}function C(){r.alwaysVisible||(u=setTimeout(function(){if((!r.disableFadeOut||!n)&&!i&&!s){b.fadeOut("slow");y.fadeOut("slow")}},1e3))}var n,i,s,u,a,f,l,c,h="<div></div>",p=30,d=!1,v=e(this);if(v.parent().hasClass("slimScrollDiv")){var m=v.scrollTop();b=v.parent().find(".slimScrollBar");y=v.parent().find(".slimScrollRail");T();if(t){"scrollTo"in t?m=parseInt(r.scrollTo):"scrollBy"in t&&(m+=parseInt(r.scrollBy));S(m,!1,!0)}return}r.height=r.height=="auto"?v.parent().innerHeight():r.height;var g=e(h).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});v.css({overflow:"hidden",width:r.width,height:r.height});var y=e(h).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.size,background:r.railColor,opacity:r.railOpacity,zIndex:90}),b=e(h).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.size,BorderRadius:r.size,MozBorderRadius:r.size,WebkitBorderRadius:r.size,zIndex:99}),w=r.position=="right"?{right:r.distance}:{left:r.distance};y.css(w);b.css(w);v.wrap(g);v.parent().append(b);v.parent().append(y);b.draggable({axis:"y",containment:"parent",start:function(){s=!0},stop:function(){s=!1;C()},drag:function(t){S(0,e(this).position().top,!1)}});y.hover(function(){N()},function(){C()});b.hover(function(){i=!0},function(){i=!1});v.hover(function(){n=!0;N();C()},function(){n=!1;C()});v.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(a=e.originalEvent.touches[0].pageY)});v.bind("touchmove",function(e){e.originalEvent.preventDefault();if(e.originalEvent.touches.length){var t=(a-e.originalEvent.touches[0].pageY)/r.touchScrollStep;S(t,!0)}});var E=function(e){if(!n)return;var e=e||window.event,t=0;e.wheelDelta&&(t=-e.wheelDelta/120);e.detail&&(t=e.detail/3);S(t,!0);e.preventDefault&&!d&&e.preventDefault();d||(e.returnValue=!1)},x=function(){if(window.addEventListener){this.addEventListener("DOMMouseScroll",E,!1);this.addEventListener("mousewheel",E,!1)}else document.attachEvent("onmousewheel",E)};x();T();e(window).resize(function(){T();N()});if(r.start=="bottom"){b.css({top:v.outerHeight()-b.outerHeight()});S(0,!0)}else if(typeof r.start=="object"){S(e(r.start).position().top,null,!0);r.alwaysVisible||b.hide()}});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);